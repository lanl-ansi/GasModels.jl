<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Mathematical Model · GasModels</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-367975-10"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-367975-10', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="GasModels logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">GasModels</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../quickguide/">Getting Started</a></li><li><a class="tocitem" href="../data-format/">Input Data Formats</a></li><li><a class="tocitem" href="../network-data/">Network Data Format</a></li><li><a class="tocitem" href="../result-data/">Result Data Format</a></li><li class="is-active"><a class="tocitem" href>Mathematical Model</a><ul class="internal"><li><a class="tocitem" href="#Steady-State-Gas-Flow"><span>Steady State Gas Flow</span></a></li><li><a class="tocitem" href="#Transient-Gas-Flow"><span>Transient Gas Flow</span></a></li></ul></li><li><a class="tocitem" href="../direction/">Direction Model</a></li></ul></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../formulations/">Network Formulations</a></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Steady State Specifications</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../ss-specifications/">Problem Specifications</a></li><li><a class="tocitem" href="../objective/">Objective</a></li><li><a class="tocitem" href="../variables/">Variables</a></li><li><a class="tocitem" href="../constraints/">Constraints</a></li></ul></li><li><a class="tocitem" href="../transient-specifications/">Transient Specifications</a></li><li><a class="tocitem" href="../parser/">File IO</a></li></ul></li><li><a class="tocitem" href="../developer/">Developer</a></li><li><a class="tocitem" href="../examples/">Examples</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Mathematical Model</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Mathematical Model</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/lanl-ansi/GasModels.jl/blob/master/docs/src/math-model.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="The-GasModels-Mathematical-Model"><a class="docs-heading-anchor" href="#The-GasModels-Mathematical-Model">The GasModels Mathematical Model</a><a id="The-GasModels-Mathematical-Model-1"></a><a class="docs-heading-anchor-permalink" href="#The-GasModels-Mathematical-Model" title="Permalink"></a></h1><p>As GasModels implements a variety of gas network optimization problems, the implementation is the best reference for precise mathematical formulations.  This section provides a mathematical specification for a prototypical Gas Flow problem, to provide an overview of the typical mathematical models in GasModels.</p><h2 id="Steady-State-Gas-Flow"><a class="docs-heading-anchor" href="#Steady-State-Gas-Flow">Steady State Gas Flow</a><a id="Steady-State-Gas-Flow-1"></a><a class="docs-heading-anchor-permalink" href="#Steady-State-Gas-Flow" title="Permalink"></a></h2><p>GasModels implements a steady-state model of gas flow based on the Weymouth formulation that uses the 1-D hydrodynamic equations for natural gas flow in a pipe. In the following paragraphs, a derivation of the steady state equations used in GasModels is shown. To that end, we first assume that the flow is steady. Given this assumption, the conservation of momentum equation for the flow of gas in a pipe is given by</p><p class="math-container">\[p \frac{\partial p}{\partial x} = -\frac{\lambda a^2 \phi |\phi|}{2 D}\]</p><p>where <span>$p$</span> is pressure, <span>$\lambda$</span> is a non dimensional friction factor, <span>$\phi$</span> is mass flux, and <span>$D$</span> is the diameter of the pipe. Here, <span>$a^2=\frac{ZRT}{m}$</span> where <span>$Z$</span> is the gas compressibility factor, <span>$R$</span> is the universal gas constant, <span>$m$</span> is the molar mass of the gas, and <span>$T$</span> is the gas temperature. Again, for steady flow, the mass conservation reduces to:</p><p class="math-container">\[    \frac{\partial \phi}{\partial x}=0,\]</p><p>where we have assumed the pipe area does not change with <span>$x$</span>. We also assume that gas pressure and gas density (<span>$\rho$</span>) satisfy the equation of state, i.e. <span>$p = a^2 \rho$</span></p><p>Given that <span>$p \frac{\partial p}{\partial x}= \frac{1}{2} \frac{\partial p^2}{\partial x}$</span> and <span>$\phi$</span> is a constant througout the pipe (from the mass conservation), the conservation of momentum equation is integrated from the start of the pipe at <span>$x=0$</span> to the end of the pipe at <span>$x=L$</span>, where <span>$L$</span> is the length of the pipe. Then, the equation for flux across the pipe is stated as</p><p class="math-container">\[    p^2(L)-p^2(0) = \frac{-\lambda L a^2 \phi |\phi|}{ D }.\]</p><p>We typically express the mass flux through the pipe in terms of mass flow, <span>$f$</span>, where <span>$f=\phi A$</span>. Here, <span>$A=\frac{\pi D^2}{4}$</span> is the cross-sectional area of the pipe. Thus, the equation for mass flow through the pipe is stated as</p><p class="math-container">\[    p^2(L)-p^2(0) = \frac{-\lambda L a^2 f |f|}{ D A^2}.\]</p><p>To create a better numerically conditioned problem, it is very useful to non-dimensionalize the units. Here we use a typical pressure <span>$p_0$</span> and a typical mass flow <span>$f_0$</span> and normalize the equations. This yields</p><p class="math-container">\[    \tilde{p}^2(L)-\tilde{p}^2(0) = -\tilde{f} |\tilde{f}| \left(\frac{\lambda L }{D}\right) \left(\frac{f_0^2a^2}{A^2p_0^2}\right),\]</p><p>where <span>$\tilde{f}=\frac{f}{f_0}$</span> and <span>$\tilde{p}=\frac{p}{p_0}$</span> are the dimensionless mass flow and pressure, respectively, and are both of order one. Note that both terms in parenthesis on the right hand side of this equation are dimensionless.  For the purposes of convenience, we define <em>resistance</em>, <span>$w$</span>, as the constant</p><p class="math-container">\[w=\left(\frac{\lambda L }{D}\right) \left(\frac{f_0^2a^2}{A^2p_0^2}\right).\]</p><p>Finally, in most data sets, nodal injections and withdrawals are defined in terms of volumetric flow, <span>$q$</span>, at a STP conditions. Given this data, we non-dimensionalize based on <span>$q$</span>. At STP conditions, the mass flow is derived as <span>$f=\frac{q}{\rho_s}$</span>, where  <span>$\rho_s$</span> is the gas density at STP conditions.</p><p>A complete gas flow mathematical model is the defined by</p><p class="math-container">\[\begin{aligned}
\text{sets:} \\
&amp; N &amp; \text{junctions} \\
&amp; A^p &amp; \text{pipes}  \\
&amp; A^c &amp; \text{compressors}  \\
&amp; A^v &amp; \text{valves}  \\
&amp; A = A^p \cup A^c \cup A^v &amp; \text{edges }  \\
&amp; P, P_i &amp; \text{producers and producers at junction $i$}   \\
&amp; C, C_i &amp; \text{consumers and consumers at junction $i$}    \\
%
\text{data:} \\
&amp; w_a &amp; \text{resistance factor of pipeline $a$} \\
&amp; fl_j &amp; \text{consumption (mass flow) at consumer $j$} \\
&amp; fg_j &amp; \text{production (mass flow) at producer $j$} \\
&amp; \underline{\alpha}_a=1, \overline{\alpha}_a &amp; \text{(de)compression limits (squared) of edge $a$} \\
&amp; \underline{p}_i \ge 0,\overline{p}_i &amp; \text{limits on pressure squared at node $i$} \\
%
\text{variables:} \\
&amp; p_i &amp; \text{pressure squared at node $i$} \\
&amp; f_a &amp; \text{mass flow on edge $a$} \\
&amp; \alpha_a &amp; \text{compression ratio on compressor $a$}\\
&amp; v_a &amp; \text{valve status for valve $a$, 1 if valve is open}\\
%
\text{constraints:} \\
&amp; (p_i - p_j) = {w}_{a} |f_{a}|f_{a} &amp;\text{Weymouth equation for pipe $a$} \\
&amp;&amp; \text{connected from junction $i$ to junction $j$}  \\
&amp;\sum\limits_{a=a_{ij}\in A} f_{a} - \sum\limits_{a=a_{ji} \in A} f_{a} = \sum_{j \in P_i} fg_j- \sum_{j \in C_i} fl_j &amp; \text{mass flow balance at junction $i$} \\
&amp; \alpha_a p_i = p_j &amp; \text{compression boost at compressor $a$} \\
&amp;&amp;\text{mass flux balance at junction $i$} \\
&amp; f_a (1-\alpha_a) \le 0&amp; \text{compression ratio is forced to 1} \\
&amp;&amp; \text{when flow is reversed through compressor $a$} \\
&amp;\underline{{p}}_i \leq p_i \leq \overline{p}_i &amp; \text{pressure limits at junction $i$} \\
&amp;\underline{{\alpha}}_a \leq \alpha_a \leq \overline{\alpha}_a &amp; \text{compression limits at compressor $i$} \\
&amp;-v_a M \leq f_a \leq v_a M &amp; \text{on/off operations for valve $a$} \\
&amp;&amp; \text{where $M$ is the maximum flow through the valve} \\
&amp;p_j - v_a \overline{p}_j \leq p_i \leq p_j + v_a \overline{p}_i &amp; \text{links junction pressures of valve $a$} \\
&amp;&amp; \text{connected from junction $i$ to junction $j$}
\end{aligned}\]</p><p>most of the optimization models of GasModels are variations of this formulation. In practice, we discretize on flow direction to reduce the non convexities of this model and relax the assumption that the minimum compression ratio is 1.</p><p>SI Units for various parameters</p><table><tr><th style="text-align: right">Parameter</th><th style="text-align: center">Description</th><th style="text-align: right">SI Units</th></tr><tr><td style="text-align: right"><span>$D$</span></td><td style="text-align: center">Pipe Diameter</td><td style="text-align: right">m</td></tr><tr><td style="text-align: right"><span>$L$</span></td><td style="text-align: center">Pipe Length</td><td style="text-align: right">m</td></tr><tr><td style="text-align: right"><span>$A$</span></td><td style="text-align: center">Pipe Area Cross Section</td><td style="text-align: right">m^2</td></tr><tr><td style="text-align: right"><span>$p$</span></td><td style="text-align: center">Gas Pressure</td><td style="text-align: right">pascals</td></tr><tr><td style="text-align: right"><span>$\rho$</span></td><td style="text-align: center">Gas Density</td><td style="text-align: right">kg/m^3</td></tr><tr><td style="text-align: right"><span>$Z$</span></td><td style="text-align: center">Gas compressibility factor</td><td style="text-align: right">none</td></tr><tr><td style="text-align: right"><span>$m$</span></td><td style="text-align: center">Gas Molar Mass</td><td style="text-align: right">kg/mol</td></tr><tr><td style="text-align: right"><span>$T$</span></td><td style="text-align: center">Gas Temperature</td><td style="text-align: right">K</td></tr><tr><td style="text-align: right"><span>$R$</span></td><td style="text-align: center">Universal Gas Constant</td><td style="text-align: right">J/mol/K</td></tr><tr><td style="text-align: right"><span>$\phi$</span></td><td style="text-align: center">Gas Mass Flux</td><td style="text-align: right">kg/m^2/s</td></tr><tr><td style="text-align: right"><span>$f$</span></td><td style="text-align: center">Gas Mass Flow</td><td style="text-align: right">kg/s</td></tr><tr><td style="text-align: right"><span>$\lambda$</span></td><td style="text-align: center">Pipe friction factor</td><td style="text-align: right">none</td></tr><tr><td style="text-align: right"><span>$a$</span></td><td style="text-align: center">Speed of sound</td><td style="text-align: right">m/s</td></tr></table><h2 id="Transient-Gas-Flow"><a class="docs-heading-anchor" href="#Transient-Gas-Flow">Transient Gas Flow</a><a id="Transient-Gas-Flow-1"></a><a class="docs-heading-anchor-permalink" href="#Transient-Gas-Flow" title="Permalink"></a></h2><p>The transient gas flow dynamics implements a lumped element reduced-order model presented in <a href="https://ieeexplore.ieee.org/abstract/document/8412133/">this paper</a> and its (<a href="https://arxiv.org/pdf/1803.07156">arxiv version</a>). An interested reader is referred to that work for detailed development of the dynamics. </p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../result-data/">« Result Data Format</a><a class="docs-footer-nextpage" href="../direction/">Direction Model »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Thursday 26 February 2026 22:04">Thursday 26 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
